<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>NativeLessCompilerOptionsBuilder.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">LessCSS Compiler</a> &gt; <a href="index.source.html" class="el_package">biz.gabrys.lesscss.compiler2</a> &gt; <span class="el_source">NativeLessCompilerOptionsBuilder.java</span></div><h1>NativeLessCompilerOptionsBuilder.java</h1><pre class="source lang-java linenums">/*
 * LessCSS Compiler
 * http://lesscss-compiler.projects.gabrys.biz/
 *
 * Copyright (c) 2015 Adam Gabry≈õ
 *
 * This file is licensed under the BSD 3-Clause (the &quot;License&quot;).
 * You may not use this file except in compliance with the License.
 * You may obtain:
 *  - a copy of the License at project page
 *  - a template of the License at https://opensource.org/licenses/BSD-3-Clause
 */
package biz.gabrys.lesscss.compiler2;

import java.io.File;
import java.util.ArrayList;
import java.util.Collection;
import java.util.Collections;
import java.util.List;

import biz.gabrys.lesscss.compiler2.util.ListWithoutEmptyValuesBuilder;
import biz.gabrys.lesscss.compiler2.util.StringUtils;

/**
 * Responsible for creating options that control the {@link NativeLessCompiler} compilation process.
 * @since 2.0.0
 * @see &lt;a href=&quot;http://lesscss.org/usage/index.html#command-line-usage-options&quot;&gt;Less options&lt;/a&gt;
 */
public class NativeLessCompilerOptionsBuilder {

    private File input;
    private File output;
    private boolean silent;
    private boolean strictImports;
    private boolean compress;
<span class="fc" id="L36">    private boolean ieCompatability = true;</span>
<span class="fc" id="L37">    private boolean javaScriptEnabled = true;</span>
<span class="fc" id="L38">    private List&lt;String&gt; includePaths = Collections.emptyList();</span>
<span class="fc" id="L39">    private LineNumbersValue lineNumbers = LineNumbersValue.DISABLED;</span>
    private boolean sourceMapDefault;
    private File sourceMapFile;
    private boolean sourceMapInline;
    private String sourceMapRootPath;
    private String sourceMapBasePath;
    private boolean sourceMapLessInline;
    private String sourceMapUrl;
    private String rootPath;
    private boolean relativeUrls;
    private boolean strictMath;
    private boolean strictUnits;

    /**
     * Constructs a new instance.
     * @since 2.0.0
     */
<span class="fc" id="L56">    public NativeLessCompilerOptionsBuilder() {</span>
        // do nothing
<span class="fc" id="L58">    }</span>

    /**
     * Sets an input (source) file.
     * @param input the input file.
     * @return {@code this} builder.
     * @since 2.0.0
     */
    public NativeLessCompilerOptionsBuilder withInputFile(final File input) {
<span class="fc" id="L67">        this.input = input;</span>
<span class="fc" id="L68">        return this;</span>
    }

    /**
     * Returns a command line option which represents an absolute path of the input file.
     * @return the command line option (never {@code null}).
     * @since 2.0.0
     * @see #withInputFile(File)
     */
    protected String getInputFileCompilerOption() {
<span class="fc bfc" id="L78" title="All 2 branches covered.">        if (input != null) {</span>
<span class="fc" id="L79">            return input.getAbsolutePath();</span>
        } else {
<span class="fc" id="L81">            return &quot;&quot;;</span>
        }
    }

    /**
     * Sets an output (destination) file. This method must be used together with {@link #withInputFile(File)}.
     * @param output the output file.
     * @return {@code this} builder.
     * @since 2.0.0
     * @see #withInputFile(File)
     */
    public NativeLessCompilerOptionsBuilder withOutputFile(final File output) {
<span class="fc" id="L93">        this.output = output;</span>
<span class="fc" id="L94">        return this;</span>
    }

    /**
     * Returns a command line option which represents an absolute path of the output file.
     * @return the command line option (never {@code null}).
     * @since 2.0.0
     * @see #withOutputFile(File)
     */
    protected String getOutputFileCompilerOption() {
<span class="fc bfc" id="L104" title="All 2 branches covered.">        if (output != null) {</span>
<span class="fc" id="L105">            return output.getAbsolutePath();</span>
        } else {
<span class="fc" id="L107">            return &quot;&quot;;</span>
        }
    }

    /**
     * Sets whether a compiler shouldn't log compilation warnings (default: {@code false}).
     * @param silent {@code true} whether the compiler shouldn't log compilation warnings, otherwise {@code false}.
     * @return {@code this} builder.
     * @since 2.0.0
     */
    public NativeLessCompilerOptionsBuilder withSilent(final boolean silent) {
<span class="fc" id="L118">        this.silent = silent;</span>
<span class="fc" id="L119">        return this;</span>
    }

    /**
     * Returns a command line option which enables/disables logging compilation warnings.
     * @return the command line option (never {@code null}).
     * @since 2.0.0
     * @see #withSilent(boolean)
     */
    protected String getSilentCompilerOption() {
<span class="fc bfc" id="L129" title="All 2 branches covered.">        if (silent) {</span>
<span class="fc" id="L130">            return &quot;--silent&quot;;</span>
        } else {
<span class="fc" id="L132">            return &quot;&quot;;</span>
        }
    }

    /**
     * Sets whether a compiler should disallow an &amp;#64;import operation inside of either &amp;#64;media blocks or other
     * selector blocks (default: {@code false}).
     * @param strictImports {@code true} whether the compiler should disallow the &amp;#64;import operation inside of either
     *            &amp;#64;media blocks or other selector blocks, otherwise {@code false}.
     * @return {@code this} builder.
     * @since 2.0.0
     */
    public NativeLessCompilerOptionsBuilder withStrictImports(final boolean strictImports) {
<span class="fc" id="L145">        this.strictImports = strictImports;</span>
<span class="fc" id="L146">        return this;</span>
    }

    /**
     * Returns a command line option which enables/disables strict imports.
     * @return the command line option (never {@code null}).
     * @since 2.0.0
     * @see #withStrictImports(boolean)
     */
    protected String getStrictImportsCompilerOption() {
<span class="fc bfc" id="L156" title="All 2 branches covered.">        if (strictImports) {</span>
<span class="fc" id="L157">            return &quot;--strict-imports&quot;;</span>
        } else {
<span class="fc" id="L159">            return &quot;&quot;;</span>
        }
    }

    /**
     * Sets whether a CSS code should be compressed (default: {@code false}).
     * @param compress {@code true} whether the CSS code should be compressed, otherwise {@code false}.
     * @return {@code this} builder.
     * @since 2.0.0
     */
    public NativeLessCompilerOptionsBuilder withCompress(final boolean compress) {
<span class="fc" id="L170">        this.compress = compress;</span>
<span class="fc" id="L171">        return this;</span>
    }

    /**
     * Returns a command line option which enables/disables a CSS code compression.
     * @return the command line option (never {@code null}).
     * @since 2.0.0
     * @see #withCompress(boolean)
     */
    protected String getCompressCompilerOption() {
<span class="fc bfc" id="L181" title="All 2 branches covered.">        if (compress) {</span>
<span class="fc" id="L182">            return &quot;--compress&quot;;</span>
        } else {
<span class="fc" id="L184">            return &quot;&quot;;</span>
        }
    }

    /**
     * Sets whether a CSS code should be compatible with IE browser (default: {@code true}). Used for the
     * {@code data-uri} function to ensure that images aren't created that are too large for the browser to handle.
     * @param ieCompatability {@code true} whether the CSS code should be compatible with IE browser, otherwise
     *            {@code false}.
     * @return {@code this} builder.
     * @since 2.0.0
     */
    public NativeLessCompilerOptionsBuilder withIeCompatability(final boolean ieCompatability) {
<span class="fc" id="L197">        this.ieCompatability = ieCompatability;</span>
<span class="fc" id="L198">        return this;</span>
    }

    /**
     * Returns a command line option which enables/disables compatibility with IE browser.
     * @return the command line option (never {@code null}).
     * @since 2.0.0
     * @see #withIeCompatability(boolean)
     */
    protected String getIeCompatabilityCompilerOption() {
<span class="fc bfc" id="L208" title="All 2 branches covered.">        if (ieCompatability) {</span>
<span class="fc" id="L209">            return &quot;&quot;;</span>
        } else {
<span class="fc" id="L211">            return &quot;--no-ie-compat&quot;;</span>
        }
    }

    /**
     * Sets whether a compiler should allow usage of JavaScript language (default: {@code true}).
     * @param javaScriptEnabled {@code true} whether the compiler should allow usage of JavaScript language, otherwise
     *            {@code false}.
     * @return {@code this} builder.
     * @since 2.0.0
     */
    public NativeLessCompilerOptionsBuilder withJavaScriptEnabled(final boolean javaScriptEnabled) {
<span class="fc" id="L223">        this.javaScriptEnabled = javaScriptEnabled;</span>
<span class="fc" id="L224">        return this;</span>
    }

    /**
     * Returns a command line option which allows/disallows usage of JavaScript language.
     * @return the command line option (never {@code null}).
     * @since 2.0.0
     * @see #withJavaScriptEnabled(boolean)
     */
    protected String getJavaScriptEnabledCompilerOption() {
<span class="fc bfc" id="L234" title="All 2 branches covered.">        if (javaScriptEnabled) {</span>
<span class="fc" id="L235">            return &quot;&quot;;</span>
        } else {
<span class="fc" id="L237">            return &quot;--no-js&quot;;</span>
        }
    }

    /**
     * Sets available include paths (default: empty collection). If the file in an &amp;#64;import rule does not exist at
     * that exact location, less will look for it at the location(s) passed to this option. You might use this for
     * instance to specify a path to a library which you want to be referenced simply and relatively in the less files.
     * @param includePaths the available include paths.
     * @return {@code this} builder.
     * @since 2.0.0
     */
    public NativeLessCompilerOptionsBuilder withIncludePaths(final List&lt;String&gt; includePaths) {
<span class="fc bfc" id="L250" title="All 4 branches covered.">        if (includePaths == null || includePaths.isEmpty()) {</span>
<span class="fc" id="L251">            this.includePaths = Collections.emptyList();</span>
        } else {
<span class="fc" id="L253">            this.includePaths = new ArrayList&lt;String&gt;(includePaths);</span>
        }
<span class="fc" id="L255">        return this;</span>
    }

    /**
     * Returns a command line option representation of the available include paths.
     * @return the command line option (never {@code null}).
     * @since 2.0.0
     * @see #withIncludePaths(List)
     */
    protected String getIncludePathsCompilerOption() {
<span class="fc bfc" id="L265" title="All 2 branches covered.">        if (includePaths.isEmpty()) {</span>
<span class="fc" id="L266">            return &quot;&quot;;</span>
        }
<span class="fc" id="L268">        final StringBuilder paths = new StringBuilder();</span>
<span class="fc bfc" id="L269" title="All 2 branches covered.">        for (final String path : includePaths) {</span>
<span class="pc bpc" id="L270" title="1 of 2 branches missed.">            if (StringUtils.isNotBlank(path)) {</span>
<span class="fc bfc" id="L271" title="All 2 branches covered.">                final boolean separatorRequired = paths.length() != 0;</span>
<span class="fc bfc" id="L272" title="All 2 branches covered.">                if (separatorRequired) {</span>
<span class="fc" id="L273">                    paths.append(NativeLessCompiler.INCLUDE_PATHS_SEPARATOR);</span>
                }
<span class="fc" id="L275">                paths.append(path.trim());</span>
            }
<span class="fc" id="L277">        }</span>
<span class="fc" id="L278">        return &quot;--include-path=&quot; + paths.toString();</span>
    }

    /**
     * Sets whether a compiler should generate inline source-mapping (default: {@link LineNumbersValue#DISABLED}). This
     * was the only option before browsers started supporting Source Maps.
     * @param lineNumbers the line numbers value ({@code null} is treated as {@link LineNumbersValue#DISABLED}).
     * @return {@code this} builder.
     * @since 2.0.0
     */
    public NativeLessCompilerOptionsBuilder withLineNumbers(final LineNumbersValue lineNumbers) {
<span class="fc bfc" id="L289" title="All 2 branches covered.">        this.lineNumbers = lineNumbers != null ? lineNumbers : LineNumbersValue.DISABLED;</span>
<span class="fc" id="L290">        return this;</span>
    }

    /**
     * Returns a command line option which enables/disables generating inline source-mapping.
     * @return the command line option (never {@code null}).
     * @since 2.0.0
     * @see #withJavaScriptEnabled(boolean)
     */
    protected String getLineNumbersCompilerOption() {
<span class="fc bfc" id="L300" title="All 2 branches covered.">        if (lineNumbers == LineNumbersValue.DISABLED) {</span>
<span class="fc" id="L301">            return &quot;&quot;;</span>
        } else {
<span class="fc" id="L303">            return &quot;--line-numbers=&quot; + lineNumbers.value;</span>
        }
    }

    /**
     * Sets whether a compiler should generate a Source Map file with a default name equal to
     * {@link #withOutputFile(File) output file name} plus {@code .map} suffix. It does not matter whether you call this
     * method before or after the {@link #withOutputFile(File)} method.
     * &lt;p&gt;
     * This method clears bulider's data set by the {@link #withSourceMapFile(File)} and the
     * {@link #withSourceMapInline(boolean)} methods.
     * &lt;/p&gt;
     * @param enabled {@code true} whether the compiler should generate the Source Map file, otherwise {@code false}.
     * @return {@code this} builder.
     * @since 2.0.0
     * @see #withOutputFile(File)
     * @see #withSourceMapFile(File)
     * @see #withSourceMapInline(boolean)
     */
    public NativeLessCompilerOptionsBuilder withSourceMapDefault(final boolean enabled) {
<span class="fc" id="L323">        sourceMapDefault = enabled;</span>
<span class="fc" id="L324">        sourceMapFile = null;</span>
<span class="fc" id="L325">        sourceMapInline = false;</span>
<span class="fc" id="L326">        return this;</span>
    }

    /**
     * Returns a command line option which enables/disables generating a Source Map file with default name.
     * @return the command line option (never {@code null}).
     * @since 2.0.0
     * @see #withSourceMapDefault(boolean)
     */
    protected String getSourceMapDefaultCompilerOption() {
<span class="fc bfc" id="L336" title="All 2 branches covered.">        if (sourceMapDefault) {</span>
<span class="fc" id="L337">            return &quot;--source-map&quot;;</span>
        } else {
<span class="fc" id="L339">            return &quot;&quot;;</span>
        }
    }

    /**
     * Sets whether a compiler should generate a Source Map file.
     * &lt;p&gt;
     * This method clears bulider's data set by the {@link #withSourceMapDefault(boolean)} and the
     * {@link #withSourceMapInline(boolean)} methods.
     * &lt;/p&gt;
     * @param sourceMap the Source Map file.
     * @return {@code this} builder.
     * @since 2.0.0
     * @see #withSourceMapDefault(boolean)
     * @see #withSourceMapInline(boolean)
     */
    public NativeLessCompilerOptionsBuilder withSourceMapFile(final File sourceMap) {
<span class="fc" id="L356">        sourceMapDefault = false;</span>
<span class="fc" id="L357">        sourceMapFile = sourceMap;</span>
<span class="fc" id="L358">        sourceMapInline = false;</span>
<span class="fc" id="L359">        return this;</span>
    }

    /**
     * Returns a command line option which enables/disables generating a Source Map file.
     * @return the command line option (never {@code null}).
     * @since 2.0.0
     * @see #withSourceMapFile(File)
     */
    protected String getSourceMapFileCompilerOption() {
<span class="fc bfc" id="L369" title="All 2 branches covered.">        if (sourceMapFile != null) {</span>
<span class="fc" id="L370">            return &quot;--source-map=&quot; + sourceMapFile.getAbsolutePath();</span>
        } else {
<span class="fc" id="L372">            return &quot;&quot;;</span>
        }
    }

    /**
     * Sets whether a compiler should generate a Source Map and put it to CSS code. This is not recommended for
     * production, but for development it allows the compiler to produce a single output file which in browsers that
     * support it, use the compiled CSS but show you the non-compiled Less source.
     * &lt;p&gt;
     * This method clears bulider's data set by the {@link #withSourceMapDefault(boolean)} and the
     * {@link #withSourceMapFile(File)} methods.
     * &lt;/p&gt;
     * @param inline {@code true} whether the compiler should generate a Source Map, otherwise {@code false}.
     * @return {@code this} builder.
     * @since 2.0.0
     * @see #withSourceMapDefault(boolean)
     * @see #withSourceMapFile(File)
     * @see #withSourceMapLessInline(boolean)
     */
    public NativeLessCompilerOptionsBuilder withSourceMapInline(final boolean inline) {
<span class="fc" id="L392">        sourceMapDefault = false;</span>
<span class="fc" id="L393">        sourceMapFile = null;</span>
<span class="fc" id="L394">        sourceMapInline = inline;</span>
<span class="fc" id="L395">        return this;</span>
    }

    /**
     * Returns a command line options which enables/disables generating a Source Map which will be put to CSS code.
     * @return the command line options (never {@code null}).
     * @since 2.0.0
     * @see #withSourceMapInline(boolean)
     */
    protected String[] getSourceMapInlineCompilerOptions() {
<span class="fc bfc" id="L405" title="All 2 branches covered.">        if (sourceMapInline) {</span>
<span class="fc" id="L406">            return new String[] { &quot;--source-map&quot;, &quot;--source-map-map-inline&quot; };</span>
        } else {
<span class="fc" id="L408">            return new String[0];</span>
        }
    }

    /**
     * Sets whether a compiler should include all of the Less files in to the Source Map. This means that you only need
     * your map file to get to your original source.
     * &lt;p&gt;
     * This can be used in conjunction with the {@link #withSourceMapInline(boolean) map inline} option so that you do
     * not need to have any additional external files at all.
     * &lt;/p&gt;
     * @param inline {@code true} whether the compiler should include all of the Less files in to the Source Map,
     *            otherwise {@code false}.
     * @return {@code this} builder.
     * @since 2.0.0
     * @see #withSourceMapInline(boolean)
     */
    public NativeLessCompilerOptionsBuilder withSourceMapLessInline(final boolean inline) {
<span class="fc" id="L426">        sourceMapLessInline = inline;</span>
<span class="fc" id="L427">        return this;</span>
    }

    /**
     * Returns a command line options which enables/disables generating a Source Map which will be put to CSS code.
     * @return the command line options (never {@code null}).
     * @since 2.0.0
     * @see #withSourceMapLessInline(boolean)
     */
    protected String getSourceMapLessInlineCompilerOption() {
<span class="fc bfc" id="L437" title="All 2 branches covered.">        if (sourceMapLessInline) {</span>
<span class="fc" id="L438">            return &quot;--source-map-less-inline&quot;;</span>
        } else {
<span class="fc" id="L440">            return &quot;&quot;;</span>
        }
    }

    /**
     * Sets a path that will be prepended to each of the Less file paths inside the Source Map and also to the path to
     * the map file specified in your output CSS.
     * &lt;p&gt;
     * Use it if for instance you have a CSS file generated in the root on your web server but have your source
     * less/css/map files in a different folder.
     * &lt;/p&gt;
     * &lt;p&gt;
     * Example: if you have a follow file structure:
     * &lt;/p&gt;
     * 
     * &lt;pre&gt;
     * output.css
     * dev-files/output.css.map
     * dev-files/output.less
     * &lt;/pre&gt;
     * &lt;p&gt;
     * then you should set the Source Map root path to {@code dev-files/}.
     * &lt;/p&gt;
     * &lt;p&gt;
     * This option is the opposite of the {@link NativeLessCompilerOptionsBuilder#withSourceMapBasePath(String) Source
     * Map base path} option.
     * &lt;/p&gt;
     * @param rootPath the path which will be added.
     * @return {@code this} builder.
     * @since 2.0.0
     * @see #withSourceMapBasePath(String)
     * @see #withSourceMapUrl(String)
     */
    public NativeLessCompilerOptionsBuilder withSourceMapRootPath(final String rootPath) {
<span class="fc" id="L474">        sourceMapRootPath = rootPath;</span>
<span class="fc" id="L475">        return this;</span>
    }

    /**
     * Returns a command line option representation of the Source Map root path.
     * @return the command line option (never {@code null}).
     * @since 2.0.0
     * @see #withSourceMapRootPath(String)
     */
    protected String getSourceMapRootPathCompilerOption() {
<span class="fc bfc" id="L485" title="All 2 branches covered.">        if (sourceMapRootPath != null) {</span>
<span class="fc" id="L486">            return &quot;--source-map-rootpath=&quot; + sourceMapRootPath;</span>
        } else {
<span class="fc" id="L488">            return &quot;&quot;;</span>
        }
    }

    /**
     * Sets a path that will be removed from each of the Less file paths inside the Source Map and also from the path to
     * the map file specified in your output CSS.
     * &lt;p&gt;
     * It specifies a path which should be removed from the output paths. For instance if you are compiling a file in
     * the less-files directory but the source files will be available on your web server in the root or current
     * directory, you can specify this to remove the additional less-files part of the path.
     * &lt;/p&gt;
     * &lt;p&gt;
     * This option is the opposite of the {@link NativeLessCompilerOptionsBuilder#withSourceMapRootPath(String) Source
     * Map root path} option.
     * &lt;/p&gt;
     * @param basePath the path which will be removed.
     * @return {@code this} builder.
     * @since 2.0.0
     * @see #withSourceMapRootPath(String)
     * @see #withSourceMapUrl(String)
     */
    public NativeLessCompilerOptionsBuilder withSourceMapBasePath(final String basePath) {
<span class="fc" id="L511">        sourceMapBasePath = basePath;</span>
<span class="fc" id="L512">        return this;</span>
    }

    /**
     * Returns a command line option representation of the Source Map base path.
     * @return the command line option (never {@code null}).
     * @since 2.0.0
     * @see #withSourceMapBasePath(String)
     */
    protected String getSourceMapBasePathCompilerOption() {
<span class="fc bfc" id="L522" title="All 2 branches covered.">        if (sourceMapBasePath != null) {</span>
<span class="fc" id="L523">            return &quot;--source-map-basepath=&quot; + sourceMapBasePath;</span>
        } else {
<span class="fc" id="L525">            return &quot;&quot;;</span>
        }
    }

    /**
     * Sets a path which will overwrite the URL in the CSS that points at the Source Map map file. This is for cases
     * when the {@link #withSourceMapRootPath(String) root path} and the {@link #withSourceMapBasePath(String) base
     * path} options are not producing exactly what you need.
     * @param url the Source Map URL.
     * @return {@code this} builder.
     * @since 2.0.0
     * @see #withSourceMapBasePath(String)
     * @see #withSourceMapRootPath(String)
     */
    public NativeLessCompilerOptionsBuilder withSourceMapUrl(final String url) {
<span class="fc" id="L540">        sourceMapUrl = url;</span>
<span class="fc" id="L541">        return this;</span>
    }

    /**
     * Returns a command line option representation of the Source Map URL.
     * @return the command line option (never {@code null}).
     * @since 2.0.0
     * @see #withSourceMapUrl(String)
     */
    protected String getSourceMapUrlCompilerOption() {
<span class="fc bfc" id="L551" title="All 2 branches covered.">        if (sourceMapUrl != null) {</span>
<span class="fc" id="L552">            return &quot;--source-map-url=&quot; + sourceMapUrl;</span>
        } else {
<span class="fc" id="L554">            return &quot;&quot;;</span>
        }
    }

    /**
     * Sets a path which will be added to every generated import and URL in CSS code (default: {@code null}). This does
     * not affect less import statements that are processed, just ones that are left in the output CSS.
     * &lt;p&gt;
     * For instance, if all the images the CSS use are in a folder called resources, you can use this option to add this
     * on to the URL's and then have the name of that folder configurable.
     * &lt;/p&gt;
     * @param rootPath the path which will be added.
     * @return {@code this} builder.
     * @since 2.0.0
     */
    public NativeLessCompilerOptionsBuilder withRootPath(final String rootPath) {
<span class="fc" id="L570">        this.rootPath = rootPath;</span>
<span class="fc" id="L571">        return this;</span>
    }

    /**
     * Returns a command line option representation of the root path.
     * @return the command line option (never {@code null}).
     * @since 2.0.0
     * @see #withRootPath(String)
     */
    protected String getRootPathCompilerOption() {
<span class="fc bfc" id="L581" title="All 2 branches covered.">        if (rootPath != null) {</span>
<span class="fc" id="L582">            return &quot;--rootpath=&quot; + rootPath;</span>
        } else {
<span class="fc" id="L584">            return &quot;&quot;;</span>
        }
    }

    /**
     * Sets whether the compiler should rewrite relative URLs (default: {@code false}). By default URLs are kept as-is,
     * so if you import a file in a sub-directory that references an image, exactly the same URL will be output in the
     * CSS code. This option allows you to re-write URLs in imported files so that the URL is always relative to the
     * base imported file. Example:
     * 
     * &lt;pre&gt;
     * # main.less
     * &amp;#64;import &quot;files/backgrounds.less&quot;;
     * 
     * # files/backgrounds.less
     * .icon-1 {
     *     background-image: url('images/lamp-post.png');
     * }
     * &lt;/pre&gt;
     * &lt;p&gt;
     * this will output the following normally
     * &lt;/p&gt;
     * 
     * &lt;pre&gt;
     * .icon-1 {
     *     background-image: url('images/lamp-post.png');
     * }
     * &lt;/pre&gt;
     * &lt;p&gt;
     * but with this option on it will instead output
     * &lt;/p&gt;
     * 
     * &lt;pre&gt;
     * .icon-1 {
     *     background-image: url('files/images/lamp-post.png');
     * }
     * &lt;/pre&gt;
     * &lt;p&gt;
     * You may also want to consider using the {@code data-uri} function instead of this option, which will embed images
     * into the CSS.
     * &lt;/p&gt;
     * @param relativeUrls {@code true} whether the compiler should rewrite relative URLs, otherwise {@code false}.
     * @return {@code this} builder.
     * @since 2.0.0
     */
    public NativeLessCompilerOptionsBuilder withRelativeUrls(final boolean relativeUrls) {
<span class="fc" id="L630">        this.relativeUrls = relativeUrls;</span>
<span class="fc" id="L631">        return this;</span>
    }

    /**
     * Returns a command line option which enables/disables rewriting relative URLs.
     * @return the command line option (never {@code null}).
     * @since 2.0.0
     * @see #withRelativeUrls(boolean)
     */
    protected String getRelativeUrlsCompilerOption() {
<span class="fc bfc" id="L641" title="All 2 branches covered.">        if (relativeUrls) {</span>
<span class="fc" id="L642">            return &quot;--relative-urls&quot;;</span>
        } else {
<span class="fc" id="L644">            return &quot;&quot;;</span>
        }
    }

    /**
     * Sets whether a compiler should try and process all maths in Less code (default: {@code false}). Without this
     * option on Less will try and process all maths in your Less e.g.:
     * 
     * &lt;pre&gt;
     * .class {
     *     height: calc(100% - 10px);
     * }
     * &lt;/pre&gt;
     * &lt;p&gt;
     * will be processed currently.
     * &lt;/p&gt;
     * &lt;p&gt;
     * With strict math on, only maths that is inside unnecessary parenthesis will be processed. For instance.
     * &lt;/p&gt;
     * 
     * &lt;pre&gt;
     * .class {
     *     width: calc(100% - ((10px  - 5px)));
     *     height: (100px / 4px);
     *     font-size: 1 / 4;
     * }
     * &lt;/pre&gt;
     * 
     * &lt;pre&gt;
     * .class {
     *     width: calc(100% - 5px);
     *     height: 25px;
     *     font-size: 1 / 4;
     * }
     * &lt;/pre&gt;
     * 
     * @param strictMath {@code true} whether the compiler should try and process all maths in the Less code, otherwise
     *            {@code false}.
     * @return {@code this} builder.
     * @since 2.0.0
     */
    public NativeLessCompilerOptionsBuilder withStrictMath(final boolean strictMath) {
<span class="fc" id="L686">        this.strictMath = strictMath;</span>
<span class="fc" id="L687">        return this;</span>
    }

    /**
     * Returns a command line option which enables/disables strict math.
     * @return the command line option (never {@code null}).
     * @since 2.0.0
     * @see #withStrictMath(boolean)
     */
    protected String getStrictMathCompilerOption() {
<span class="fc bfc" id="L697" title="All 2 branches covered.">        if (strictMath) {</span>
<span class="fc" id="L698">            return &quot;--strict-math=on&quot;;</span>
        } else {
<span class="fc" id="L700">            return &quot;&quot;;</span>
        }
    }

    /**
     * Sets whether the compiler should guess units in Less code when it does maths (default: {@code false}). Without
     * this option, Less compiler attempts to guess at the output unit when it does maths. For instance
     * 
     * &lt;pre&gt;
     * .class {
     *     property: 1px * 2px;
     * }
     * &lt;/pre&gt;
     * &lt;p&gt;
     * In this case, things are clearly not right - a length multiplied by a length gives an area, but CSS does not
     * support specifying areas. So we assume that the user meant for one of the values to be a value, not a unit of
     * length and Less outputs 2px. With strict units on, Less assumes this is a bug in the calculation and throw an
     * error.
     * &lt;/p&gt;
     * @param strictUnits {@code true} whether the compiler should guess units in the Less code when it does maths,
     *            otherwise {@code false}.
     * @return {@code this} builder.
     * @since 2.0.0
     */
    public NativeLessCompilerOptionsBuilder withStrictUnits(final boolean strictUnits) {
<span class="fc" id="L725">        this.strictUnits = strictUnits;</span>
<span class="fc" id="L726">        return this;</span>
    }

    /**
     * Returns a command line option which enables/disables strict units.
     * @return the command line option (never {@code null}).
     * @since 2.0.0
     * @see #withStrictUnits(boolean)
     */
    protected String getStrictUnitsCompilerOption() {
<span class="fc bfc" id="L736" title="All 2 branches covered.">        if (strictUnits) {</span>
<span class="fc" id="L737">            return &quot;--strict-units=on&quot;;</span>
        } else {
<span class="fc" id="L739">            return &quot;&quot;;</span>
        }
    }

    /**
     * Creates a collection with configuration options for the {@link NativeLessCompiler} compilation process.
     * @return the collection with configuration options.
     * @throws BuilderCreationException if you set an output file without setting an input file.
     * @since 2.0.0
     */
    public Collection&lt;Object&gt; create() {
<span class="fc" id="L750">        final ListWithoutEmptyValuesBuilder options = new ListWithoutEmptyValuesBuilder();</span>
<span class="fc" id="L751">        options.add(getSilentCompilerOption());</span>
<span class="fc" id="L752">        options.add(getStrictImportsCompilerOption());</span>
<span class="fc" id="L753">        options.add(getCompressCompilerOption());</span>
<span class="fc" id="L754">        options.add(getIeCompatabilityCompilerOption());</span>
<span class="fc" id="L755">        options.add(getJavaScriptEnabledCompilerOption());</span>
<span class="fc" id="L756">        options.add(getIncludePathsCompilerOption());</span>
<span class="fc" id="L757">        options.add(getLineNumbersCompilerOption());</span>

<span class="fc" id="L759">        options.add(getSourceMapDefaultCompilerOption());</span>
<span class="fc" id="L760">        options.add(getSourceMapFileCompilerOption());</span>
<span class="fc" id="L761">        options.add(getSourceMapInlineCompilerOptions());</span>
<span class="fc" id="L762">        options.add(getSourceMapLessInlineCompilerOption());</span>
<span class="fc" id="L763">        options.add(getSourceMapRootPathCompilerOption());</span>
<span class="fc" id="L764">        options.add(getSourceMapBasePathCompilerOption());</span>
<span class="fc" id="L765">        options.add(getSourceMapUrlCompilerOption());</span>

<span class="fc" id="L767">        options.add(getRootPathCompilerOption());</span>
<span class="fc" id="L768">        options.add(getRelativeUrlsCompilerOption());</span>
<span class="fc" id="L769">        options.add(getStrictMathCompilerOption());</span>
<span class="fc" id="L770">        options.add(getStrictUnitsCompilerOption());</span>

<span class="fc" id="L772">        final String inputPath = getInputFileCompilerOption();</span>
<span class="fc" id="L773">        options.add(inputPath);</span>
<span class="fc" id="L774">        final String outputPath = getOutputFileCompilerOption();</span>
<span class="fc bfc" id="L775" title="All 2 branches covered.">        if (StringUtils.isNotBlank(outputPath)) {</span>
<span class="fc bfc" id="L776" title="All 2 branches covered.">            if (StringUtils.isBlank(inputPath)) {</span>
<span class="fc" id="L777">                throw new BuilderCreationException(&quot;input file is required when otuput file is set (see #withInputFile(File))&quot;);</span>
            }
<span class="fc" id="L779">            options.add(outputPath);</span>
        }
<span class="fc" id="L781">        return options.create();</span>
    }

    /**
     * Available values for {@link NativeLessCompilerOptionsBuilder#withLineNumbers(LineNumbersValue) line numbers}
     * option.
     * @since 2.0.0
     */
<span class="pc" id="L789">    public enum LineNumbersValue {</span>

        /**
         * Line numbers won't be put in CSS code.
         * @since 2.0.0
         */
<span class="fc" id="L795">        DISABLED(&quot;&quot;),</span>
        /**
         * Line numbers will be put in CSS comments blocks.
         * @since 2.0.0
         */
<span class="fc" id="L800">        COMMENTS(&quot;comments&quot;),</span>
        /**
         * Line numbers will be put in &amp;#64;media queries.
         * @since 2.0.0
         */
<span class="fc" id="L805">        MEDIA_QUERY(&quot;mediaquery&quot;),</span>
        /**
         * Line numbers will be put in CSS comments blocks and &amp;#64;media queries.
         * @since 2.0.0
         */
<span class="fc" id="L810">        ALL(&quot;all&quot;);</span>

        private String value;

<span class="fc" id="L814">        LineNumbersValue(final String value) {</span>
<span class="fc" id="L815">            this.value = value;</span>
<span class="fc" id="L816">        }</span>

        /**
         * Returns a value assigned to this object.
         * @return the value assigned to this object.
         * @since 2.0.0
         */
        public String getValue() {
<span class="fc" id="L824">            return value;</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.8.201612092310</span></div></body></html>